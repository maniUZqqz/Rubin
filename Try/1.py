from openai import OpenAI
from pinecone import Pinecone,ServerlessSpec
from pinecone.grpc import PineconeGRPC as Pinecone
import time
import os

#initialaizing

index_name="https://rubin-test-ewtlu8f.svc.aped-4627-b74a.pinecone.io"

api_key="pcsk_7H4WbG_33hAKLnEGUfgejZSpVRvdhThoyhnfD4fAp6fy4pMjGzu8gduGYtDzu6inKmyVbf"

pc = Pinecone(api_key=api_key)
index = pc.Index(index_name)

client = OpenAI(base_url="https://api.avalai.ir/v1", api_key="aa-bCMbGUMwByZarx3MXTKend7CBc39XhlofwT7RnBtvIrUSSxc")

# Define a sample dataset where each item has a unique ID, text, and category
data = [
    {
        "id": "rec0",
        "text": "Apple.",
        "category": "digestive system" 
    },
    # {
    #     "id": "rec1",
    #     "text": "Apples are a great source of dietary fiber, which supports digestion and helps maintain a healthy gut.",
    #     "category": "digestive system" 
    # },
    # {
    #     "id": "rec2",
    #     "text": "Apples originated in Central Asia and have been cultivated for thousands of years, with over 7,500 varieties available today.",
    #     "category": "cultivation"
    # },
    # {
    #     "id": "rec3",
    #     "text": "Rich in vitamin C and other antioxidants, apples contribute to immune health and may reduce the risk of chronic diseases.",
    #     "category": "immune system"
    # },
    # {
    #     "id": "rec4",
    #     "text": "The high fiber content in apples can also help regulate blood sugar levels, making them a favorable snack for people with diabetes.",
    #     "category": "endocrine system"
    # }
]


response = client.embeddings.create(
    input=[d["text"] for d in data],
    model="text-embedding-3-small"
)
# embeddings=response
embeddings=[[0.006933887489140034, -0.025943810120224953, -0.015834318473935127, 0.05421833693981171, -0.015295339748263359, -0.03997182101011276, 0.003710940945893526, 0.02911941334605217, 0.010917959734797478, -0.018907953053712845, 0.03528125211596489, 0.013459899462759495, -0.04335136339068413, 0.0072325109504163265, -0.0021996155846863985, 0.0005184938199818134, -0.04638129845261574, 0.03781590610742569, -0.015149669721722603, 0.01335792988538742, -0.024647347629070282, 0.0484498105943203, 0.0006172762368805707, 0.030794618651270866, 0.03589306399226189, -0.005735752638429403, -0.04174899309873581, -0.005193131975829601, 0.024545378983020782, -0.035863932222127914, 0.01822330430150032, -0.04040883108973503, 0.03158123418688774, -0.03184344246983528, 0.011937648989260197, 0.012447493150830269, 0.02394813299179077, -0.025929242372512817, -0.015018567442893982, 0.0013192230835556984, -0.01579061709344387, 0.029643826186656952, 0.03292139992117882, 0.008820313028991222, 0.04480806365609169, -0.050052180886268616, -0.07802080363035202, -0.007858891040086746, 0.01752408966422081, 0.011223866604268551, -0.0387190617620945, 0.02016071416437626, 0.010866974480450153, 0.010728588327765465, -0.04894508793950081, 0.03379541635513306, -0.03434896469116211, 0.037932444363832474, 0.02868240512907505, 0.03504817932844162, 0.016038255766034126, -0.03228045254945755, -0.002876980695873499, 0.013168559409677982, 0.013379780575633049, -0.04110804572701454, -0.006114494055509567, 0.032163914293050766, 0.023817028850317, 0.00010595209460007027, -0.008441571146249771, -0.009708899073302746, -0.04635216295719147, 0.018645748496055603, 0.0429726205766201, -0.03158123418688774, -7.841137994546443e-05, 0.007480149623006582, 0.009140786714851856, 0.03624267131090164, 0.03382455185055733, 0.04483719542622566, -0.035426922142505646, -0.09468543529510498, 0.05783095210790634, 0.00733812153339386, -0.04690571129322052, -0.013474466279149055, -0.08448854833841324, -0.029978865757584572, 0.010051223449409008, 0.006303864996880293, -0.005120296962559223, 0.002048483118414879, -0.023904431611299515, 0.0660758689045906, -0.02319064922630787, 0.0035907630808651447, -0.012476627714931965, -0.012782534584403038, 0.015499277971684933, -0.028405630961060524, -0.043759237974882126, -0.008732911199331284, 0.0266575925052166, -0.03484424203634262, 0.01732015237212181, -0.017465822398662567, -0.03257179260253906, 0.044429320842027664, -0.01615479215979576, 0.013765806332230568, -0.007946292869746685, -0.027327673509716988, -0.014115413650870323, -0.022841041907668114, -0.02342372015118599, -0.04343876615166664, 0.028361931443214417, -0.05497582256793976, -0.02865326963365078, 0.03487337380647659, -0.002487313700839877, 0.009599646553397179, 0.017116213217377663, 0.024166638031601906, -0.03828205168247223, -0.02971666119992733, -0.013445332646369934, -0.07411684840917587, 0.03440723195672035, -0.015120536088943481, 0.054451409727334976, -0.025900108739733696, 0.033970221877098083, -0.02474931627511978, -0.01918472722172737, 0.0497608408331871, -0.012491194531321526, 0.036359209567308426, 0.03737889602780342, 0.0020630499348044395, -5.7499779359204695e-05, 0.006759083829820156, 0.019242994487285614, -0.01510596927255392, 0.003984071779996157, -0.017946531996130943, -0.03799071162939072, 0.021748516708612442, 0.03085288591682911, -0.0182961393147707, -0.02485128492116928, 0.02102016657590866, 0.01467624306678772, -0.03018280491232872, 0.027895787730813026, 0.02568160369992256, -0.09002400189638138, 0.0113768195733428, -0.048653747886419296, -0.01224355585873127, -0.019344963133335114, -0.013285095803439617, -0.047721460461616516, 0.08070112764835358, -0.03382455185055733, -0.014217382296919823, -0.07172786444425583, 0.024661915376782417, -0.05200415477156639, -0.0008908624877221882, 0.006835560314357281, 0.00044224472367204726, 0.006857411004602909, -0.03140643239021301, 0.05357738956809044, -0.02045205421745777, -0.06386168301105499, 0.01427565049380064, -0.02469104900956154, 0.028099725022912025, -0.002348927315324545, 0.0010269727790728211, 0.0034287055023014545, -0.03627180680632591, 0.029978865757584572, -0.019840240478515625, -0.03924347087740898, -0.004686929285526276, 0.009330157190561295, 0.028842641040682793, 0.006485952530056238, -0.003505181986838579, -0.026074912399053574, -0.005153072997927666, 0.0522954948246479, -0.06421129405498505, -0.027997756376862526, -0.00667896494269371, 0.04693484306335449, 0.01695597730576992, 0.037932444363832474, -0.013489033095538616, -0.03600960224866867, 0.007764205802232027, -0.021107569336891174, 0.05086793005466461, 0.022709937766194344, -0.03545605391263962, 0.0453033410012722, -0.034465499222278595, -0.016737472265958786, 0.014749078080058098, -0.04984823986887932, -0.021806783974170685, 0.023409154266119003, -0.006522370036691427, -0.011959499679505825, 0.055616769939661026, 0.023773329332470894, 0.03804897889494896, 0.03382455185055733, 0.054917555302381516, -0.011041779071092606, 0.005702976603060961, 0.008456137962639332, -0.015965420752763748, 0.019374096766114235, -0.03740803152322769, 0.024676481261849403, 0.03991355374455452, -0.04993564262986183, -0.03641747683286667, 0.030794618651270866, 0.0035853006411343813, -0.016737472265958786, -0.01364198699593544, -0.030037134885787964, -0.023642225190997124, -0.03595133125782013, -0.00754570122808218, 0.004701496101915836, 0.03312533721327782, -0.013438048772513866, -0.0029188606422394514, -0.02005874551832676, 0.00227791303768754, -0.024734750390052795, 0.06176403909921646, 0.022462299093604088, 0.03976788371801376, 0.04483719542622566, -0.011354968883097172, 0.019446931779384613, 0.001206328859552741, 0.007436448708176613, 0.028099725022912025, 0.018208738416433334, -0.040292296558618546, -0.04265214875340462, -0.002545581664890051, -0.030794618651270866, -0.040700171142816544, 0.00999295525252819, 0.007301704026758671, -0.027094602584838867, 0.007381822448223829, -0.011930365115404129, 0.03906866908073425, -0.028493033722043037, 0.031173359602689743, 0.047634057700634, 0.05360652506351471, 0.048158470541238785, -0.04128285124897957, -0.02021898329257965, -0.010743155144155025, -0.018033934757113457, -0.02422490529716015, -0.03624267131090164, 0.004326396156102419, 0.0012363733258098364, 0.019869375973939896, 0.037058424204587936, -0.042564745992422104, 0.024093803018331528, 0.0014803704107180238, -0.008572674356400967, -0.01985480822622776, -0.02182135172188282, -0.0361844040453434, 0.0034013923723250628, 0.010655753314495087, 0.03175603970885277, 0.04032142832875252, 0.01832527481019497, -0.010277011431753635, -0.0025929242838174105, -0.02725483849644661, 0.07324282824993134, 0.027240272611379623, 0.019665436819195747, -0.0009969284292310476, -0.04504113644361496, -0.004377380479127169, -0.04874115064740181, -0.008040978573262691, 0.0024308664724230766, -0.018267005681991577, -0.022841041907668114, 0.047459255903959274, 0.07038769870996475, -0.04340963065624237, 
-0.04320569336414337, -0.07557354867458344, 0.0009240934741683304, -0.028493033722043037, -0.029774928465485573, -0.04134111851453781, 0.027342241257429123, -0.018878819420933723, -0.012498477473855019, 0.012797101400792599, -0.020947331562638283, -0.016446132212877274, 0.004424723330885172, -0.00642040092498064, -0.002246958203613758, -0.03662141412496567, -0.028376497328281403, -0.020845362916588783, -0.008747478015720844, -0.023365452885627747, -0.00996382161974907, -0.03828205168247223, 0.043293096125125885, -0.022345762699842453, -0.020743394270539284, -0.025331996381282806, -0.016941409558057785, -0.04614822566509247, 0.00015136013098526746, -0.024661915376782417, 0.017480388283729553, -0.0265556238591671, 0.014195532537996769, -0.007844324223697186, -0.003141007386147976, 0.04393404349684715, -0.06601759791374207, 0.012513045221567154, 0.015411876142024994, -0.029891464859247208, -0.008601807989180088, -0.01334336306899786, 0.03507731482386589, -0.0410497784614563, -0.014501439407467842, 0.053985267877578735, -0.015295339748263359, 0.025331996381282806, 0.04396317899227142, -0.03061981499195099, -0.003834760282188654, 0.02585640735924244, -0.07522393763065338, -0.0311150923371315, 0.02811429090797901, -0.01656266860663891, -0.02702176757156849, -0.003040859242901206, 0.003111873287707567, -0.009636064060032368, -0.00707227410748601, 0.017742594704031944, 0.021733948960900307, 0.03510644659399986, 0.040991511195898056, 0.006642547901719809, -0.026832396164536476, 0.03906866908073425, 0.024210337549448013, -0.046526968479156494, -0.02182135172188282, 0.002192332176491618, 0.015149669721722603, 0.03603873401880264, -0.015135102905333042, 0.021311506628990173, 0.05937505513429642, -0.01609652489423752, 0.034669436514377594, -0.0379033088684082, -0.022200092673301697, 0.023613091558218002, 0.006329357158392668, 0.029862331226468086, -0.018514644354581833, 0.01576148346066475, 0.0002749519480857998, -0.03667968139052391, -0.018412675708532333, 0.03021193854510784, 0.010561068542301655, -0.028726104646921158, -0.008223066106438637, 0.02981862984597683, -0.021311506628990173, 
-0.01236009132117033, 0.06945540755987167, -0.008689209818840027, 0.08460508286952972, -0.0027913996018469334, 0.018864253535866737, -0.049527768045663834, 0.01612565852701664, 0.003532495116814971, 0.014588841237127781, -0.0036126135382801294, 0.018747717142105103, -0.012833518907427788, 0.013918759301304817, -0.023860730230808258, 0.003940370865166187, 0.017771728336811066, 0.011085479520261288, -0.013627419248223305, 0.034960776567459106, -0.06409475952386856, 0.05241203308105469, 0.05101360008120537, -0.0038784611970186234, -0.010116774588823318, -0.014843763783574104, -0.03222218155860901, -0.044254519045352936, -0.003740074811503291, 0.027109168469905853, 0.008813029155135155, 0.00377649231813848, -0.03708755970001221, 0.027429644018411636, -0.013620136305689812, -0.02435600757598877, 0.023729627951979637, -0.03292139992117882, -0.007301704026758671, -0.01718904823064804, -0.026963500306010246, -0.044400185346603394, -0.013510883785784245, -0.04603169113397598, 0.006540578790009022, 0.009708899073302746, 0.00147399737033993, 0.0008357811020687222, 0.01705794595181942, -0.003709119977429509, -0.03807811439037323, 0.028172560036182404, 0.010801423341035843, -0.0019720064010471106, 0.022068990394473076, 0.03388281911611557, 0.01959260180592537, 0.021937888115644455, 0.039563946425914764, 0.004639586433768272, 0.02394813299179077, 0.006642547901719809, 0.012920920737087727, -0.0340576246380806, 0.019738271832466125, -0.027808384969830513, 0.03504817932844162, 0.03061981499195099, 0.002283375710248947, -0.017742594704031944, -0.05579157546162605, -0.0315229669213295, 0.018602047115564346, -0.02611861377954483, 0.011085479520261288, -0.028595002368092537, 0.10709651559591293, 0.013940609991550446, 0.062638059258461, -0.021238671615719795, -0.01609652489423752, 0.008565390482544899, 0.028959177434444427, 0.012010484002530575, -0.017946531996130943, 0.04574035108089447, 0.02568160369992256, 0.007472866214811802, -0.04891595244407654, -0.005433487240225077, -0.018616613000631332, 0.025506800040602684, -0.051421474665403366, -0.01520793791860342, 0.030445009469985962, 0.011806545779109001, 0.04737185314297676, 0.021835919469594955, 0.040263161063194275, 0.00274405675008893, -0.029308784753084183, 0.025331996381282806, 0.01519337110221386, 0.007403673138469458, -0.020364653319120407, -0.05383959785103798, 0.0011498818639665842, 0.00868192594498396, 0.0313190296292305, -0.02352568879723549, 1.661547321418766e-05, -0.03717495873570442, -0.025594202801585197, -0.0020994674414396286, -0.03198911249637604, -0.024574512615799904, -0.022462299093604088, -0.008040978573262691, -0.01935953088104725, 0.0029716661665588617, -0.04160332307219505, 0.010881542228162289, -0.007112333085387945, -0.015062267892062664, -0.04265214875340462, -0.009752600453794003, 0.020029611885547638, 0.0088931480422616, 0.009657914750277996, 0.018048500642180443, -2.6431122023495845e-05, 0.04807106778025627, 0.010058507323265076, -0.028900908306241035, 0.003947654273360968, -0.02495325542986393, -0.028026890009641647, -0.007454657461494207, -0.01612565852701664, -0.003408675780519843, 0.03411589190363884, -0.045856885612010956, 0.027444209903478622, 0.015470144338905811, -0.012753400020301342, 0.05153801292181015, 0.005174923222512007, 0.012498477473855019, 0.0062601640820503235, -0.00847798865288496, 0.05867583677172661, -0.01335792988538742, 0.006536936853080988, 0.002507343189790845, -0.025900108739733696, -0.0010378981241956353, 0.013103008270263672, 0.0054990388453006744, 0.008186648599803448, -0.0003368616453371942, -0.0023325392976403236, 0.00941027607768774, -0.002419941360130906, -0.023613091558218002, -0.03268832713365555, 0.011194732040166855, 0.03440723195672035, 0.016766605898737907, -0.015339041128754616, 0.011901231482625008, 0.039330873638391495, -0.028332795947790146, -0.024603646248579025, -0.05500495433807373, 0.028157992288470268, -0.011180165223777294, 0.0011617174604907632, 0.0009932866087183356, -0.0191555917263031, -0.014195532537996769, -0.012112452648580074, 0.03379541635513306, -0.013845924288034439, -0.01708707958459854, 0.005509964190423489, -0.006427684333175421, 0.0012272689491510391, -0.03589306399226189, 0.017567791044712067, 0.00475612236186862, 0.036330074071884155, -0.019344963133335114, -0.024472543969750404, -9.827028407016769e-05, 0.0030918437987565994, -0.012513045221567154, 0.021442610770463943, -0.0005926944431848824, -0.015266206115484238, 0.011668159626424313, 0.00615455349907279, 0.00847798865288496, -0.001189030590467155, 0.015266206115484238, 0.005517247598618269, 0.025098925456404686, -0.008252199739217758, 0.00738910585641861, -0.008623658679425716, 0.01382407359778881, 0.003911236766725779, -0.01520793791860342, -0.007618536241352558, -0.00418801000341773, 0.025637904182076454, 0.025098925456404686, 0.014239232987165451, 0.0014812808949500322, 0.016999678686261177, -0.009213621728122234, -0.00020757962192874402, -0.004279053304344416, 0.0059287650510668755, 0.036796219646930695, 0.006536936853080988, 0.006431326270103455, -0.01032799668610096, 0.0037145826499909163, -3.5137174563715234e-05, -0.0073927477933466434, 0.00802641175687313, -0.0330379344522953, 0.001990215154364705, 0.0030608889646828175, -0.014537856914103031, 0.020816229283809662, -0.008696493692696095, 0.008813029155135155, -0.012076035141944885, -0.03737889602780342, 0.017334718257188797, 0.03484424203634262, -0.0533151850104332, 0.012636864557862282, 0.004271769896149635, 0.030911153182387352, 0.033737149089574814, -0.05080966278910637, 0.011697293259203434, -0.003871177788823843, 0.022870175540447235, -0.006158195436000824, -0.014974866062402725, -0.015644947066903114, -0.013911476358771324, 
-0.022214660421013832, -0.0035944050177931786, -0.02562333643436432, 0.02472018264234066, 0.032134782522916794, -0.02342372015118599, 0.024603646248579025, 0.032863128930330276, 0.015936287119984627, -0.01902448944747448, 0.010983510874211788, -0.017247317358851433, 0.0054007116705179214, -0.0076112523674964905, 0.021267805248498917, -0.006857411004602909, -0.010357130318880081, 0.011238433420658112, -0.0427686832845211, -0.014829196035861969, -0.0009186308598145843, -0.008201215416193008, -0.0005499038961715996, 0.012534894980490208, 0.008456137962639332, -0.007192451506853104, -0.01708707958459854, 0.019344963133335114, 0.02218552678823471, 0.015484711155295372, 0.005149431060999632, -0.004708779510110617, 0.021282372996211052, 0.011522489599883556, -0.020102446898818016, -0.017043378204107285, 0.009344724006950855, 0.008827595971524715, -0.005160356406122446, -0.03784504160284996, -0.03134816512465477, -0.01317584328353405, -0.021107569336891174, -0.005298743024468422, 0.04291435331106186, 0.018966222181916237, 0.03158123418688774, -0.005287817679345608, -0.032426122575998306, 0.013095724396407604, 0.016970543190836906, 0.01882055215537548, 0.00760396895930171, 0.00029293308034539223, 0.03825291618704796, -0.03175603970885277, -0.018267005681991577, 0.013678404502570629, 0.021704815328121185, -0.028041455894708633, -0.010204176418483257, -0.03685448691248894, -0.032134782522916794, -0.013649269938468933, -0.009162637405097485, 0.01457427442073822, -0.03673794865608215, 0.0014302963390946388, 0.00636213319376111, 0.006132702808827162, -0.0013155813794583082, 0.01925756223499775, -0.04810020327568054, -0.025565069168806076, 0.0014730868861079216, 0.011165598407387733, -0.01962173543870449, 0.01899535581469536, 0.01765519194304943, -0.0009468543576076627, -0.029323352500796318, 0.023729627951979637, 0.0033758999779820442, 0.011923082172870636, -0.02831823006272316, 0.022010723128914833, 0.02562333643436432, 0.012418359518051147, 0.0089951166883111, 0.06677508354187012, 0.02608948014676571, -0.019971344619989395, 0.002554686041548848, 0.006092643830925226, 0.004708779510110617, 0.022928442806005478, 0.06438609957695007, 0.037058424204587936, 0.024006400257349014, -0.0022924800869077444, -0.00023261662863660604, -0.015280772931873798, 0.02748791128396988, -0.07120344787836075, 0.021413475275039673, 0.04448758810758591, 0.0033850043546408415, -0.0412537157535553, -0.011471505276858807, 0.011245716363191605, 0.020029611885547638, -0.03061981499195099, -0.03968048095703125, 0.005921481642872095, -0.0007319912547245622, 0.007418239954859018, 0.006424042861908674, -0.005713901948183775, -0.039593081921339035, 0.01742212101817131, -0.03734976425766945, -0.012935487553477287, -0.0088931480422616, -0.022331196814775467, -0.0653766542673111, -0.015397309325635433, 0.015907153487205505, 0.009199054911732674, -0.012680565007030964, -0.008667359128594398, 0.010706737637519836, -0.026176881045103073, 0.00029998895479366183, -0.04938209801912308, -0.012396508827805519, -0.00713054183870554, -0.0010087641421705484, -0.016708338633179665, -0.042797818779945374, -0.020743394270539284, 0.003534316085278988, 0.008499839343130589, -0.0026876097545027733, 0.024443410336971283, -0.005863213911652565, -0.014253799803555012, -0.00237806118093431, 0.002139526652172208, 0.02808515727519989, 0.031930841505527496, 0.04751752316951752, -0.07056250423192978, -0.021296940743923187, 0.015746917575597763, 0.003501540282741189, 0.026133181527256966, 0.038602523505687714, 0.009701616130769253, -0.0055354563519358635, -0.020932765677571297, 0.00817936472594738, 0.023380020633339882, -0.002026632660999894, 0.02445797622203827, 0.002978949574753642, 0.005910556297749281, 0.0264536552131176, -0.011682726442813873, 0.014960299246013165, 0.0179902333766222, 0.01689770817756653, -0.00026175062521360815, -0.03061981499195099, -0.039360009133815765, -0.06322073936462402, -0.023044979199767113, -0.009155353531241417, 0.0032903188839554787, 0.004337321501225233, -0.022098124027252197, -0.019097324460744858, -0.04253561049699783, 0.00548811350017786, 0.0034487349912524223, -0.029891464859247208, -0.0007752370438538492, -0.016781173646450043, -0.01520793791860342, -0.00982543546706438, 0.005211340729147196, -0.03673794865608215, -0.03740803152322769, 0.025739872828125954, -0.013947893865406513, -0.021835919469594955, -0.018150469288229942, -0.0009222725639119744, 0.02435600757598877, -0.030590679496526718, -0.029163114726543427, -0.0038821029011160135, -0.012141586281359196, 0.02005874551832676, -0.0018937087152153254, 0.020903632044792175, 0.004890867043286562, 0.010714021511375904, 0.019534334540367126, -0.009789017960429192, -0.06374514847993851, -6.674640462733805e-05, -0.0056119333021342754, -0.06019080430269241, 0.03868992626667023, -0.03429069742560387, 0.01918472722172737, 0.02198158949613571, -0.00894413236528635, 0.026876097545027733, 0.006056226324290037, -0.008536256849765778, 0.015339041128754616, -0.030095402151346207, 0.043263960629701614, 0.008070113137364388, 0.02585640735924244, 0.009555946104228497, -0.006919320672750473, 0.01879141852259636, -0.011952215805649757, 0.010000239126384258, -0.013918759301304817, 0.006289298180490732, 0.004315470810979605, 0.0015040417201817036, -0.020364653319120407, -0.0030262921936810017, -0.052790772169828415, 0.014872897416353226, 0.03195997700095177, -0.011966782622039318, 0.013977027498185635, 0.03507731482386589, -0.017975665628910065, 0.0013510884018614888, -0.007487433031201363, -0.012869936414062977, -0.02764814719557762, 0.04920729249715805, -0.03787417709827423, 0.018208738416433334, 0.022899309173226357, -0.005597366020083427, 0.02831823006272316, -0.03970961645245552, 0.007057706825435162, 0.0015368175227195024, -0.01141323707997799, -0.057452209293842316, 0.009810867719352245, -0.022404031828045845, 0.015280772931873798, 0.005051103886216879, 0.03947654366493225, 0.02528829500079155, -0.01812133565545082, 0.024647347629070282, 0.021544579416513443, 0.029672959819436073, 0.021806783974170685, 0.008099246770143509, -0.027444209903478622, 0.053227782249450684, -0.014530573040246964, -0.008368736132979393, -0.013787656091153622, 0.01638786494731903, -0.027560746297240257, 0.006536936853080988, -0.02402096800506115, 0.0497608408331871, -0.018514644354581833, -0.009745316579937935, 0.0024326874408870935, 0.021428043022751808, -0.0012245376128703356, -0.004111533053219318, -0.05663646012544632, 0.008193932473659515, -0.017902830615639687, 0.016416998580098152, 0.06170577183365822, 0.00019096414325758815, 0.014516006223857403, -0.0114787882193923, 0.007582118734717369, -0.005320593249052763, -0.0004074205062352121, -0.015149669721722603, -0.016431564465165138, -0.017538657411932945, 0.02485128492116928, 0.007939009927213192, 0.039330873638391495, 0.05946245416998863, -0.007265286520123482, -0.007472866214811802, -0.0060270922258496284, -0.004777973052114248, 0.0455072782933712, -0.006635264027863741, -0.04116631671786308, 0.022462299093604088, -0.02531742863357067, 0.027910353615880013, -0.024428842589259148, 0.026861529797315598, 0.0427686832845211, -0.005968824494630098, 0.014566990546882153, -0.00708684092387557, 0.02974579483270645, 0.019607169553637505, -0.003171962220221758, 0.0029334276914596558, 0.035426922142505646, -0.017713461071252823, 0.006314790342003107, -0.0032884981483221054, 0.01938866451382637, -0.00367270247079432, -0.0003036307170987129, -0.009279172867536545, 0.028143426403403282, 0.0027531611267477274, 0.03574739396572113, 0.0070831989869475365, 0.002886085072532296, -0.011624458245933056, -0.0017352927243337035, -0.0011626279447227716, -0.017815429717302322, -0.003863894147798419, 0.02132607437670231, 0.024603646248579025, 0.013459899462759495, -0.007771489210426807, -0.014523289166390896, 0.0018645747331902385, 0.003000800032168627, -0.004530333913862705, -0.002443612553179264, 0.005870497319847345, -0.025798140093684196, -0.04032142832875252, 0.03487337380647659, -0.004096966236829758, -0.029104847460985184, 0.006609771866351366, -0.026235150173306465, 0.013561868108808994, -0.01912645809352398, 0.0036654190625995398, 0.018849685788154602, 0.035193849354982376, 0.03274659439921379, -0.0005640156450681388, 0.017480388283729553, 0.023161515593528748, -0.001056106761097908, 0.020670559257268906, 0.03455290198326111, -0.003663598094135523, -0.032134782522916794, 0.011202015914022923, -0.020961899310350418, -0.013598285615444183, -0.003536137053743005, -5.0956015911651775e-05, 0.016650069504976273, -0.055587634444236755, 0.012651431374251842, -0.014028011821210384, 0.004635944962501526, -0.02039378695189953, 0.04151592403650284, 0.0039512962102890015, -0.05217896029353142, 0.008674643002450466, -0.06240498647093773, -0.009541378356516361, -0.004442932084202766, 0.014516006223857403, -0.018602047115564346, 0.030066268518567085, -0.0225497018545866, 
-0.023205215111374855, -0.0026548339519649744, 0.050984468311071396, -0.05366479232907295, 0.022112691774964333, -0.027444209903478622, 0.03289226442575455, 0.028711538761854172, 0.013059306889772415, 0.007931726053357124, 0.01426108367741108, 0.04393404349684715, -0.008572674356400967, 0.029235949739813805, 0.028332795947790146, -0.005029253661632538, -0.04949863255023956, -0.02715286985039711, 0.008987832814455032, -0.010750439018011093, 0.04265214875340462, -0.01679573953151703, -0.00817936472594738, -0.012418359518051147, -0.028026890009641647, -0.0030973064713180065, -0.009228188544511795, -0.004974627401679754, 0.0023034054320305586, -0.012301823124289513, 0.01892252080142498, -0.03452376648783684, 0.005852288566529751, 0.0381072461605072, 0.03018280491232872, 0.019942209124565125, 0.01708707958459854, 0.0024909554049372673, 0.02011701464653015, -0.0059287650510668755, 0.0014038936933502555, 0.03697102144360542, -0.014428604394197464, 0.0338536873459816, 0.003798342775553465, 0.003332199063152075, 0.00851440615952015, -0.031056823208928108, -0.03210564702749252, -0.020714260637760162, 0.019942209124565125, -0.0007451926358044147, 0.00366906076669693, 0.018864253535866737, 1.6458992831758223e-05, 0.005590082611888647, -0.020597724243998528, 0.0002961196005344391, 0.0020921840332448483, 0.02321978285908699, -0.0017917398363351822, -0.006369416601955891, 0.010888825170695782, 0.008281334303319454, -0.02671585977077484, -0.009504960849881172, -0.019272128120064735, -0.021209537982940674, -0.021180404350161552, 0.008652792312204838, -0.02161741442978382, 0.026672160252928734, 0.041661594063043594, -0.019738271832466125, 0.0005967913893982768, -0.012942771427333355, -0.0011143747251480818, -0.007771489210426807, -0.0381072461605072, 0.03210564702749252, 0.024894986301660538, 0.001125300070270896, -0.007633103057742119, 0.0038857446052134037, 0.025463098660111427, 0.023962698876857758, 0.00859452411532402, 0.11909971386194229, -0.03682535141706467, 0.04113718122243881, -0.01172642782330513, 0.007250719703733921, -0.009672481566667557, -0.001106180832721293, 0.021996155381202698, -0.003006262704730034, 0.02725483849644661, -0.028332795947790146, -0.010065790265798569, 0.027793817222118378, 0.008274050429463387, 0.000319335755193606, -0.018631180748343468, 0.02208355814218521, -0.004745197016745806, 0.005651992280036211, 0.027997756376862526, 0.01609652489423752, -0.0132268276065588, 0.01866031438112259, 0.043263960629701614, 0.00640583410859108, -0.03452376648783684, -0.011675442568957806, -0.03510644659399986, 0.010619335807859898, -0.01334336306899786, -0.005877780728042126, -0.004523050505667925, 0.016985110938549042, 0.01581975258886814, -0.01625676080584526, 0.0005248668603599072, 0.00935929175466299, -0.036359209567308426, 0.049119893461465836, -0.017145348712801933, 0.02085993066430092, -0.02608948014676571, 0.0228556077927351, 0.01656266860663891, 0.003476048121228814, -0.02758987993001938, -0.0024326874408870935, 0.0006145449005998671, -0.03379541635513306, -0.007829757407307625, -0.014253799803555012, -0.0010069431737065315, -0.018077636137604713, -0.000351201044395566, -0.009650630876421928, 0.011609891429543495, 0.017101647332310677, 0.013853208161890507, 0.043730106204748154, 0.015062267892062664, 0.01679573953151703, -0.00015875743702054024, 0.009796300902962685, 0.008259483613073826, -0.02909027971327305, -0.020641425624489784, -0.01509140245616436, -0.007141467183828354, 0.014581557363271713, 0.025026090443134308, -0.011347685940563679, 0.00944669358432293, 0.02335088513791561, -0.015237072482705116, 0.0037910593673586845, 0.024632781744003296, 0.03195997700095177, -0.03522298485040665, 0.05214982479810715, 0.057714417576789856, 0.009687048383057117, 0.026876097545027733, 0.017815429717302322, -0.004792539868503809, -0.04370097070932388, 0.0022323913872241974, -0.0007743266178295016, -0.006307506933808327, -0.03184344246983528, 0.001339252688921988, -0.0025219102390110493, 
0.0002619782171677798, 0.048857685178518295, 0.004526692442595959, 0.009628781117498875, -0.01324139442294836, -0.016650069504976273, 0.01635872945189476, -0.01782999560236931, 0.0018217843025922775, 0.0010843303753063083, -0.0015959958545863628, -0.02391899935901165, -0.04078757390379906, -0.01662093587219715, -0.0068027847446501255, -0.0023653151001781225, 0.01380950678139925, 0.0034596603363752365, 0.0108451247215271, 0.0033194529823958874, 0.006387625355273485, 0.035397786647081375, -0.02795405499637127, 0.023729627951979637, 0.0005321503849700093, 0.014603408053517342, 0.005808587651699781, -0.03155210241675377, -0.024763884022831917, 0.01689770817756653, 0.004869016353040934, 0.00801184494048357, -0.043526168912649155, 0.007946292869746685, 0.020612291991710663, 0.028536735102534294, 0.015936287119984627, 0.019898509606719017, 0.0005262325285002589, -0.0010916138999164104, 0.011595324613153934, 0.02458908036351204, -0.013037456199526787, -0.01277525071054697, 0.04891595244407654, 0.030561545863747597, 0.008689209818840027, 0.011799261905252934, -0.02085993066430092, -0.0026511922478675842, 0.031435564160346985, 0.00739638926461339, -0.027735549956560135, 0.011245716363191605, 0.00403869803994894, -0.017582356929779053, 0.0026511922478675842, -0.03382455185055733, 0.01672290451824665, -0.006136344745755196, -0.004836240783333778, -0.0006154553266242146, -0.009810867719352245, -0.006096285302191973, 0.03265919163823128, -0.025098925456404686, -0.016446132212877274, 0.007866174913942814, -0.010094924829900265, -0.027735549956560135, 0.019039057195186615, 
0.005972465965896845, -0.016081957146525383, -0.012665998190641403, -0.014231950044631958, -0.018368974328041077, -0.006609771866351366, 0.02508435770869255, -0.02528829500079155, -0.001959260320290923, 0.030095402151346207, 0.0015923541504889727, 0.012986471876502037, 0.0028569509740918875, -0.03321273997426033, 0.025900108739733696, 0.0499647781252861, -0.039126936346292496, -0.01096166018396616, -0.03828205168247223, -0.009162637405097485, -0.009250039234757423, 0.006791859399527311, -0.014581557363271713, 0.031872574239969254, -0.017436686903238297, -0.022404031828045845, -0.05008131265640259, 0.01951976679265499, 0.02955642342567444, 0.0266575925052166, -0.0014211919624358416, -0.0025310146156698465, -0.009694332256913185, 0.015251639299094677, -0.00801184494048357, 0.006285656243562698, -0.014100846834480762, 0.03452376648783684, -0.04614822566509247, 0.0065551456063985825, -0.011646308936178684, -0.0038238349370658398, 0.026672160252928734, -0.019242994487285614, 0.0076476698741316795, -0.019141025841236115, 0.015309907495975494, 0.013947893865406513, -0.011959499679505825, -0.0030262921936810017, -0.03711669147014618, 0.04556554555892944, 0.012338240630924702, 0.01292820367962122, -0.01682487316429615, 0.010932526551187038, -0.006383983418345451, -0.01276068389415741, -0.013904192484915257, 
-0.007567551452666521, 0.04177812859416008, 0.01136225275695324, -0.018150469288229942, -0.02231662906706333, 0.005389786325395107, 
-0.000560829124879092, 0.030474144965410233, -0.009424842894077301, 0.020670559257268906, 0.008725627325475216, 0.02828909642994404, -0.0064568184316158295, 0.025812707841396332, 0.027138303965330124, -0.03650487959384918, -0.0059433323331177235, 0.011005361564457417, 0.0006600667838938534, -0.011172881349921227, -0.002412657719105482, -0.006282014772295952, -0.0408458411693573, -0.036330074071884155, -0.013146708719432354, 0.05433487519621849, -0.0228556077927351, -0.00588870607316494, 0.0076476698741316795, 0.018835118040442467, -0.014945732429623604, 0.010619335807859898, -0.0023653151001781225, -0.0010205997386947274, -0.0037801340222358704, -0.003911236766725779, 0.0008744746446609497, 0.012403792701661587, -0.033766284584999084, 0.006773650646209717, 0.03274659439921379, 0.02888634242117405, -0.014785495586693287, 0.00142210244666785, 0.007225227076560259, 0.02534656412899494, 0.01142780389636755, 0.008703776635229588, 0.0357765294611454, -0.04110804572701454, 0.02045205421745777, -0.025230027735233307, 0.030270205810666084, -0.01097622700035572, -0.02811429090797901, -0.00527325039729476, 0.018835118040442467, 0.012112452648580074, -0.005411637015640736, 0.005196773912757635, -0.005193131975829601, -0.01635872945189476, -0.04093324393033981, 0.008492555469274521, 0.015979988500475883, -0.008266767486929893, -0.005692051723599434, 0.008230349980294704, -0.01965087093412876, 0.010211460292339325, 0.021879618987441063, -0.027633581310510635, -0.01718904823064804, -0.011085479520261288, -0.003636284964159131, 0.0060635097324848175, 0.018165037035942078, 0.02065599337220192, -0.012097885832190514, 0.013489033095538616, -0.016402430832386017, -0.004570393357425928, -0.03554345667362213, 0.024545378983020782, 0.020029611885547638, -0.0003684993425849825, 0.045361608266830444, -0.00982543546706438, -0.027968620881438255, 0.03210564702749252, 0.02099103294312954, -0.0641530230641365, -0.004508483689278364, 0.0002603849570732564, 0.004767047706991434, 0.03807811439037323, 0.013372497633099556, 0.025171760469675064, -0.03067808225750923, 0.011303984560072422, -0.01982567459344864, -0.0301536712795496, -0.025433965027332306, -0.02648278884589672, -0.010160475969314575, -0.01431206800043583, 0.05034352093935013, 0.015470144338905811, -0.02182135172188282, -0.019242994487285614, 0.0006892007659189403, 0.007742355577647686, 0.018398109823465347, 0.02994973212480545, -0.02125323936343193, -0.027225704863667488, 0.00248185102827847, -0.008412436582148075, 0.00025583276874385774, 0.008558106608688831, -0.0034997195471078157, 0.00470513803884387, -0.03834031894803047, 0.009665198624134064, 0.03938914090394974, 0.014231950044631958, 0.0025637904182076454, -0.013831357471644878, 0.013532734476029873, -0.004879941698163748, 0.010706737637519836, -0.02208355814218521, 0.009031534194946289, -0.015805184841156006, -0.0035488831344991922, -0.008244916796684265, -0.01628589630126953, 0.02078709565103054, -0.007141467183828354, 0.019446931779384613, 0.010386263951659203, 0.006930245552212, 0.0007169690798036754, -0.018106769770383835, 0.01858747936785221, -0.028711538761854172, 0.0410497784614563, -0.005069312639534473, -0.013904192484915257, 0.0119085144251585, 0.0113768195733428, 0.005346085410565138, -0.019199293106794357, 0.037699371576309204, 0.01246205996721983, -0.013263245113193989, 0.042389944195747375, -0.01941779814660549, -0.00055582175264135, 0.005899630952626467, -0.05724827200174332, -0.013831357471644878, -0.007582118734717369, 0.03350408002734184, 0.013540017418563366, -0.02378789521753788, -0.0016642786795273423, 0.017101647332310677]]

# print(embeddings)


# Prepare the records for upsert
# Each contains an 'id', the vector 'values', 
# and the original text and category as 'metadata'
records = []
for d, e in zip(data, embeddings):  
    
    records.append({
        "id": d["id"],
        "values": e,
        "metadata": {
            "source_text": d["text"],
            "category": d["category"]
        }
    })

# Upsert the records into the index
index.upsert(
    vectors=records,
    namespace="example-namespace"
)
